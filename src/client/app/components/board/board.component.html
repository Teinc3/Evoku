<div class="board" [class.threat-border]="hasThreatBorder">
  @for (i of indices; track i) {
    <app-cell-model
      [model]="getCellModel(i)"
      [index]="i"
      [isMe]="isMe"
      (selected)="onCellSelected($event)"
      [class.selected]="selected() === i"
      [class.highlight-related]="isRelatedCell(i)"
      [class.highlight-same-number]="isSameNumberCell(i)"
      [selectedValue]="selected() !== null ? getCellModel(selected()!).getDisplayValue() : 0"
    ></app-cell-model>
  }
  @if (cooldownHelper.currentAngle() > 0 || cooldownHelper.transitionDuration() !== '0s') {
    <div
      class="global-cooldown-overlay"
      [style.--angle]="cooldownHelper.currentAngle() + 'deg'"
      [style.transition-duration]="cooldownHelper.transitionDuration()"
    ></div>
  }
  @if (shouldPulseRow) {
    <div class="pulse-row-overlay"></div>
  }
  @if (shouldPulseCol) {
    <div class="pulse-col-overlay"></div>
  }
  @if (shouldPulseBox) {
    <div class="pulse-box-overlay"></div>
  }
  @if (threatData?.targetIndices) {
    @for (targetIdx of threatData.targetIndices; track targetIdx) {
      <div 
        class="ghost-target" 
        [style]="getGhostTargetStyle(targetIdx)"
      ></div>
    }
  }
  @for (floatingText of floatingTexts; track floatingText.id) {
    <app-floating-text
      [data]="floatingText"
      [onComplete]="removeFloatingText.bind(this)"
    ></app-floating-text>
  }
</div>
