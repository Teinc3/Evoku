/* An orb that shines 5 elemental colors when spinning for powerup */
/* Shitty Design but works for now */

/* Register custom properties so they interpolate smoothly */
@property --b {
	syntax: '<number>';
	inherits: false;
	initial-value: 1;
}

@property --orb-col {
	syntax: '<color>';
	inherits: false;
	initial-value: hsl(200 90% 55%);
}

@property --core-inset {
	syntax: '<percentage>';
	inherits: false;
	initial-value: 30%;
}

:host {
	display: block;
	max-width: 100%;
	max-height: 100%;
	aspect-ratio: 1 / 1;
}

.orb {
	position: relative;
	width: 100%;
	height: 100%;
	transition: transform 150ms ease;
}

/* Glassy outer orb shell (mostly white/transparent) */
.glass {
	position: absolute;
	inset: 0;
	border-radius: 50%;
	background:
		radial-gradient(closest-side, rgba(255,255,255,0.55), rgba(255,255,255,0.2) 60%, rgba(255,255,255,0.08) 80%),
		radial-gradient(circle at 30% 25%, rgba(255,255,255,0.85), transparent 45%),
		radial-gradient(circle at 65% 70%, rgba(255,255,255,0.35), transparent 55%);
	box-shadow:
		0 0 0.65rem rgba(255,255,255,0.6) inset,
		0 0 1.1rem rgba(0,0,0,0.22) inset,
		0 0 0.45rem rgba(255,255,255,0.25);
	pointer-events: none;
}

/* Inner core with breathing and hue cycling */
.core {
	position: absolute;
	inset: var(--core-inset, 30%);
	border-radius: 50%;
	/* Base elemental color fill and specular highlights layered on top */
	background-color: var(--orb-col);
	background-image:
		radial-gradient(circle at 30% 30%, rgba(255,255,255,0.5), transparent 60%),
		radial-gradient(circle at 70% 70%, rgba(255,255,255,0.25), transparent 60%);
		/* Default (IDLE): constant low brightness (lowered for more contrast) */
		--b: 0.7;
		/* Default inset */
		--core-inset: 30%;
	filter: brightness(var(--b));
	box-shadow: 0 0 calc(12%) rgba(255,255,255,0.35) inset, 0 0 calc(10%) rgba(255,255,255,0.25);
	    /* IDLE: slow color change with elemental palette, and a slow inset pulse */
	    animation: color-steps 10s linear infinite, core-pulse 4s ease-in-out infinite;
}

/* READY: constant high brightness, slow color change */
:host(.ready) .core {
	animation: color-steps 10s linear infinite, core-pulse 4s ease-in-out infinite;
	--b: 1.125; /* high brightness (reduced to ~75% of previous peak) */
}

/* SPINNING: brightness breath (low->high->low), colors 2x speed of IDLE/READY,
	 and one color transition duration equals one breath cycle duration */
:host(.spinning) .core {
	animation: color-steps 5s linear infinite, breath 1s linear infinite, core-pulse 2s ease-in-out infinite;
}

:host(.spinning) .orb {
  animation: spin 1.2s linear infinite;
}

:host(:hover) .orb {
	transform: scale(1.06);
}

@keyframes spin {
	to { transform: rotate(360deg); }
}

@keyframes breath {
	/* Sine-like wave from low (IDLE) to high (READY) and back (peak reduced) */
	0%   { --b: 0.70; }
	12.5%{ --b: 0.8125; }
	25%  { --b: 0.93125; }
	37.5%{ --b: 1.030625; }
	50%  { --b: 1.125; }
	62.5%{ --b: 1.030625; }
	75%  { --b: 0.93125; }
	87.5%{ --b: 0.8125; }
	100% { --b: 0.70; }
}

@keyframes core-pulse {
	0%   { --core-inset: 35%; }
	50%  { --core-inset: 25%; }
	100% { --core-inset: 35%; }
}

/* Cycle through 5 elemental colours (smoothly via registered color property) */
@keyframes color-steps {
	/* Water -> Wood -> Fire -> Earth -> Metal -> Water */
	0%   { --orb-col: hsl(200 90% 55%); }  /* Water: vivid blue */
	20%  { --orb-col: hsl(125 60% 45%); }  /* Wood: green */
	40%  { --orb-col: hsl(20 90% 55%); }   /* Fire: orange-red */
	60%  { --orb-col: hsl(50 95% 55%); }   /* Earth: golden yellow */
	80%  { --orb-col: hsl(210 6% 70%); }   /* Metal: silver-grey */
	100% { --orb-col: hsl(200 90% 55%); }  /* Back to Water */
}

@media (prefers-reduced-motion: reduce) {
	.core { animation: none; }
}
